<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>AI Code Generator</title>

<!-- Highlight.js -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

<style>
body {
  background:#0f0f0f;
  color:white;
  font-family: Arial;
  margin:0;
  padding:0;
}
.container {
  max-width:900px;
  margin:auto;
  padding:20px;
}
h1 {
  text-align:center;
}
.chat {
  margin-bottom:20px;
}
.user {
  color:#4ade80;
  margin:10px 0;
}
.bot {
  background:#111827;
  border-radius:8px;
  padding:15px;
  position:relative;
}
.copy-btn {
  position:absolute;
  top:10px;
  right:10px;
  background:#2563eb;
  border:none;
  color:white;
  padding:5px 10px;
  cursor:pointer;
  border-radius:5px;
  font-size:12px;
}
textarea {
  width:100%;
  height:90px;
  background:#1f2937;
  color:white;
  border:none;
  padding:10px;
  border-radius:5px;
  resize:none;
}
button.send {
  width:100%;
  margin-top:10px;
  padding:10px;
  background:#22c55e;
  border:none;
  color:black;
  font-size:16px;
  cursor:pointer;
  border-radius:5px;
}
pre {
  overflow-x:auto;
}
</style>
</head>

<body>
<div class="container">
  <h1>ü§ñ AI Code Generator</h1>

  <div id="chat" class="chat"></div>

  <textarea id="input" placeholder="ÿßŸÉÿ™ÿ® ÿ∑ŸÑÿ®ŸÉ ŸÖÿ´ŸÑ: ÿßÿµŸÜÿπ ŸÑŸä ÿ®Ÿàÿ™ ÿØŸäÿ≥ŸÉŸàÿ±ÿØ ÿ®ÿßŸäÿ´ŸàŸÜ"></textarea>
  <button class="send" onclick="send()">ÿ•ÿ±ÿ≥ÿßŸÑ</button>
</div>

<script>
async function send() {
  const input = document.getElementById("input");
  const chat = document.getElementById("chat");
  const message = input.value.trim();
  if (!message) return;

  chat.innerHTML += `<div class="user">üßë‚Äçüíª ${message}</div>`;
  input.value = "";

  const res = await fetch("http://localhost:1000/chat", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({ message })
  });

  const data = await res.json();

  const codeId = "code_" + Date.now();

  chat.innerHTML += `
    <div class="bot">
      <button class="copy-btn" onclick="copyCode('${codeId}')">ŸÜÿ≥ÿÆ</button>
      <pre><code id="${codeId}" class="language-python">${escapeHtml(data.reply)}</code></pre>
    </div>
  `;

  hljs.highlightAll();
}

function copyCode(id) {
  const code = document.getElementById(id).innerText;
  navigator.clipboard.writeText(code);
  alert("‚úÖ ÿ™ŸÖ ŸÜÿ≥ÿÆ ÿßŸÑŸÉŸàÿØ");
}

function escapeHtml(text) {
  return text
    .replace(/&/g, "&amp;")
    .replace(/</g, "&lt;")
    .replace(/>/g, "&gt;");
}
</script>

</body>
</html>
